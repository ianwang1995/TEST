name: BTC Daily Report Preview

on:
  workflow_dispatch:  # 手动执行

jobs:
  report:
    runs-on: ubuntu-latest
    steps:
      - name: Generate BTC Report Only (No Push)
        run: |
          echo "调用 GPT 生成快报..."
          response=$(curl -s https://api.openai.com/v1/chat/completions \
          -H "Content-Type: application/json" \
          -H "Authorization: Bearer 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" \
          -d '{
            "model": "gpt-4",
            "messages": [{"role": "user", "content": "生成一份今天的BTC快报，包含DXY，AHR999，ETF资金流趋势，总结流动性状况和操作建议，语气专业简洁，用中文回答。"}],
            "temperature": 0.7
          }')

          echo "GPT原始响应 ↓↓↓↓↓↓↓↓"
          echo "$response"

          content=$(echo "$response" | grep -oP '"content":\s*"\K([^"]+)' | sed 's/\\n/\n/g')

          echo "生成的快报内容 ↓↓↓↓↓↓↓↓"
          echo "$content"
